<nx12-header title='MANAGE_SURVEYS.TITLE'></nx12-header>

<ion-content>
    <p-table #dt [globalFilterFields]='["title", "description", "categories", "_id"]' [value]='values'
             responsiveLayout='stack'
             styleClass='p-table-stripped'>
        <ng-template pTemplate='caption'>
            <div class='flex align-items-center justify-content-between'>
                <span class='p-input-icon-left'>
                    <i class='pi pi-search'></i>
                    <input #searchInput (input)="dt.filterGlobal(searchInput.value, 'contains')" pInputText
                           placeholder="{{ 'MANAGE_SURVEYS.SEARCH' | translate }}" type='text' />
                </span>
                <span>
                    <button (click)='addClick()' class='p-button-success' icon='pi pi-plus' pButton
                            type='button'></button>
                </span>
            </div>
        </ng-template>
        <ng-template pTemplate='header'>
            <tr>
                <th pSortableColumn='title'>{{ 'MANAGE_SURVEYS.TITLE' | translate }}
                    <p-sortIcon field='title'></p-sortIcon>
                </th>
                <th>{{ 'FORM_OPERATION.ACTIONS' | translate }}</th>
            </tr>
        </ng-template>
        <ng-template let-item pTemplate='body'>
            <tr>
                <td class='text-center'>
                    <span></span>
                    <span><h5>{{ item.title }}</h5></span>
                    <span></span>
                </td>
                <td>
                    <button (click)='createToken(item)' class='p-button-primary wide-button'
                            icon='pi pi-{{ NG_ICON.key }}' pButton type='button'></button>
                    <button (click)='editClick(item)' *ngIf='userCanEdit' class='p-button-primary wide-button'
                            icon='pi pi-{{ NG_ICON.pencil }}' pButton type='button'></button>
                    <button (click)='editClick(item)' *ngIf='userCanEdit' class='p-button-primary wide-button'
                            icon='pi pi-{{ NG_ICON.download }}' pButton type='button'></button>
                    <button (click)='deleteClick(item)' *ngIf='userCanDelete' class='p-button-danger wide-button'
                            icon='pi pi-{{ NG_ICON.trash }}' pButton type='button'></button>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate='emptymessage'>
            {{ 'FORM_OPERATION.NO_ITEMS' | translate }}
        </ng-template>
    </p-table>
</ion-content>

<p-dialog [(visible)]='tokenDialog' [draggable]='true' [modal]='true' [resizable]='false' [responsive]='true'
          header='MANAGE_SURVEYS.CREATE_TOKEN'>
    <div class='p-grid'>
        <div class='p-col-12'>
            <h5>{{ generatedToken.token }}</h5>
        </div>
        <div class='p-col-12'>
            <p-button (click)='copyToken()' icon='pi pi-copy'
                      label='{{ (copied ? "FORM_OPERATION.COPIED" : "FORM_OPERATION.COPY") | translate }}'
                      styleClass='p-button-{{ copied ? "success" : "primary" }}'></p-button>
        </div>
    </div>
</p-dialog>
